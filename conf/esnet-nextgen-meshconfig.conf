##########################################################################################
# Mesh Config file for Regular testing
#
##

description ESnet Next Generation Testing

<administrator>
  name       Andy Lake
  email      andy@es.net
</administrator>

##########################################################################################
# Organizations
##

## ESnet
<organization>
    description 	ESnet
    
    <site>

        <host>
              description test-pt1.es.net
              address test-pt1.es.net
              address 198.129.254.10
              address 2001:400:201:11fd::3
              address test-owamp1.es.net
              address 198.129.252.42
              address 2001:400:201:1111::3
              
              <measurement_archive>
                  type        perfsonarbuoy/bwctl
                  read_url    http://test-pt1.es.net:8085/esmond/perfsonar/archive
                  write_url   http://test-pt1.es.net:8085/esmond/perfsonar/archive 
              </measurement_archive>
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://test-pt1.es.net:8085/esmond/perfsonar/archive
                  write_url   http://test-pt1.es.net:8085/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://test-pt1.es.net:8085/esmond/perfsonar/archive
                  write_url   http://test-pt1.es.net:8085/esmond/perfsonar/archive
              </measurement_archive>
             <measurement_archive>
                  type        pinger 
                  read_url    http://test-pt1.es.net:8085/esmond/perfsonar/archive
                  write_url   http://test-pt1.es.net:8085/esmond/perfsonar/archive
            </measurement_archive>
        </host>
    </site>
    
    <site>
        <host>
              description test-pt2.es.net
              address test-pt2.es.net
              address 198.129.254.210
              address 2001:400:201:11fe::3
              address test-owamp2.es.net
              address 198.129.252.138 
              address 2001:400:201:1112::3
              
              <measurement_archive>
                  type        perfsonarbuoy/bwctl
                  read_url    http://test-pt2.es.net:8085/esmond/perfsonar/archive
                  write_url   http://test-pt2.es.net:8085/esmond/perfsonar/archive 
              </measurement_archive>
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://test-pt2.es.net:8085/esmond/perfsonar/archive
                  write_url   http://test-pt2.es.net:8085/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://test-pt2.es.net:8085/esmond/perfsonar/archive
                  write_url   http://test-pt2.es.net:8085/esmond/perfsonar/archive
              </measurement_archive>
             <measurement_archive>
                  type        pinger 
                  read_url    http://test-pt2.es.net:8085/esmond/perfsonar/archive
                  write_url   http://test-pt2.es.net:8085/esmond/perfsonar/archive
            </measurement_archive>
        </host>

    </site>
    
     <site>

        <host>
              description sacr-pt1.es.net
              address sacr-pt1.es.net
              address sacr-pt1-v6.es.net
              
              no_agent 1
              <measurement_archive>
                  type        perfsonarbuoy/bwctl
                  read_url    http://sacr-pt1.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://sacr-pt1.es.net:8085/esmond/perfsonar/archive/ 
              </measurement_archive>
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://sacr-pt1.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://sacr-pt1.es.net:8085/esmond/perfsonar/archive/
              </measurement_archive> 
              <measurement_archive>
                  type        pinger 
                  read_url    http://sacr-pt1.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://sacr-pt1.es.net:8085/esmond/perfsonar/archive/
              </measurement_archive> 
              <measurement_archive>
                  type        traceroute
                  read_url    http://sacr-pt1.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://sacr-pt1.es.net:8085/esmond/perfsonar/archive/
              </measurement_archive>
        </host>

        <host>
              description sacr-owamp.es.net
              address sacr-owamp.es.net
              address sacr-owamp-v6.es.net
              no_agent 1
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://sacr-owamp.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://sacr-owamp.es.net:8085/esmond/perfsonar/archive/ 
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://sacr-owamp.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://sacr-owamp.es.net:8085/esmond/perfsonar/archive/
              </measurement_archive>
        </host>

    </site>
    
    <site>

        <host>
              description kans-pt1.es.net
              address kans-pt1.es.net
              address kans-pt1-v6.es.net
              no_agent 1
              <measurement_archive>
                  type        perfsonarbuoy/bwctl
                  read_url    http://kans-pt1.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://kans-pt1.es.net:8085/esmond/perfsonar/archive/ 
              </measurement_archive>
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://kans-pt1.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://kans-pt1.es.net:8085/esmond/perfsonar/archive/
              </measurement_archive>
              <measurement_archive>
                  type        pinger 
                  read_url    http://kans-pt1.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://kans-pt1.es.net:8085/esmond/perfsonar/archive/
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://kans-pt1.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://kans-pt1.es.net:8085/esmond/perfsonar/archive/
              </measurement_archive>
        </host>

        <host>
              description kans-owamp.es.net
              address kans-owamp.es.net
              address kans-owamp-v6.es.net
              no_agent 1
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://kans-owamp.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://kans-owamp.es.net:8085/esmond/perfsonar/archive/ 
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://kans-owamp.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://kans-owamp.es.net:8085/esmond/perfsonar/archive/
              </measurement_archive>
        </host>

    </site>
    
    <site>

        <host>
              description atla-pt1.es.net
              address atla-pt1.es.net
              address atla-pt1-v6.es.net
              no_agent 1
              <measurement_archive>
                  type        perfsonarbuoy/bwctl
                  read_url    http://atla-pt1.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://atla-pt1.es.net:8085/esmond/perfsonar/archive/ 
              </measurement_archive>
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://atla-pt1.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://atla-pt1.es.net:8085/esmond/perfsonar/archive/
              </measurement_archive>
              <measurement_archive>
                  type        pinger 
                  read_url    http://atla-pt1.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://atla-pt1.es.net:8085/esmond/perfsonar/archive/
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://atla-pt1.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://atla-pt1.es.net:8085/esmond/perfsonar/archive/
              </measurement_archive>
        </host>

        <host>
              description atla-owamp.es.net
              address atla-owamp.es.net
              address atla-owamp-v6.es.net
              no_agent 1
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://atla-owamp.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://atla-owamp.es.net:8085/esmond/perfsonar/archive/ 
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://atla-owamp.es.net:8085/esmond/perfsonar/archive/
                  write_url   http://atla-owamp.es.net:8085/esmond/perfsonar/archive/
              </measurement_archive>
        </host>

    </site>
</organization>

##########################################################################################
# Test specifications
##
<test_spec bwctl_6h_iperf3_test_scavenger>
  # Define a test spec for testing achievable bandwidth once every 6 hours
  type              perfsonarbuoy/bwctl  # Perform a bwctl test (i.e. achievable bandwidth)
  tool              bwctl/iperf3          # Use 'iperf' to do the bandwidh test
  protocol          tcp                  # Run a TCP bandwidth test
  interval          21600                # Run the test every 6 hours
  duration          20                   # Perform a 20 second test
  tos_bits          32			 # use scavenger service
  force_bidirectional 1                  # do bidirectional test
  random_start_percentage 10             # randomize start time
  streams                 1              #limit to 1 stream
 # window_size       67108864             # window size to 64M
  omit_interval     5                    #ignore first few seconds of test 
</test_spec>

<test_spec owamp_test>
  type              perfsonarbuoy/owamp  # Perform a constant low-bandwidth OWAMP test
  packet_interval   0.1                 # Send 10 packets every second (i.e. pause 0.1 seconds between each packet)
  loss_threshold    10                   # Wait no more than 10 seconds for a response
  session_count     10800                # Refresh the test every half hour (once every 18000 packets)
  sample_count      600                 # Send results back every 60 seconds (once every 600 packets)
  packet_padding    0                    # The size of the packets (not including the IP/UDP headers)
  bucket_width      0.0001                # The granularity of the measurements
  force_bidirectional 1                  # do bidirectional test
</test_spec>

<test_spec ping_test>
  type              pinger             
  packet_interval   1                   # Send 1 packet every second 
  test_interval     900                 # Run every 15 minutes 
  packet_size       1000                # 1000 bytes
  packet_count      100                 # 100 packets
  force_bidirectional 1
</test_spec>

<test_spec tracepath_test>
  type              traceroute          
  tool              tracepath           # use tracepath 
  test_interval     900                 # Run every 15 minutes
  timeout           30                  #wait up to 30 seconds for tracepath to complete
  force_bidirectional 1
</test_spec>

##########################################################################################
# Groups
##
<group throughput_group>
    type        disjoint
    
    a_member     198.129.254.10 #test-pt1
    a_member     198.129.254.210 #test-pt2
    
    b_member     198.129.254.10 #test-pt1
    b_member     198.129.254.210 #test-pt2
    b_member     sacr-pt1.es.net
    b_member     kans-pt1.es.net
    b_member     atla-pt1.es.net
</group>

<group latency_group>
    type        disjoint
    
    a_member     198.129.252.42 #test-owamp1
    a_member     198.129.252.138  #test-owamp2
    
    b_member     198.129.252.42 #test-owamp1
    b_member     198.129.252.138  #test-owamp2
    b_member     sacr-owamp.es.net
    b_member     kans-owamp.es.net
    b_member     atla-owamp.es.net
</group>

<group throughput_group_ipv6>
    type        disjoint
    
    a_member     2001:400:201:11fd::3 #test-pt1
    a_member     2001:400:201:11fe::3 #test-pt2
    
    b_member     2001:400:201:11fd::3 
    b_member     2001:400:201:11fe::3
    b_member     sacr-pt1-v6.es.net
    b_member     kans-pt1-v6.es.net
    b_member     atla-pt1-v6.es.net
</group>

<group latency_group_ipv6>
    type        disjoint
    
    a_member     2001:400:201:1111::3 #test-owamp1
    a_member     2001:400:201:1112::3 #test-owamp2
    
    b_member     2001:400:201:1111::3
    b_member     2001:400:201:1112::3
    b_member     sacr-owamp-v6.es.net
    b_member     kans-owamp-v6.es.net
    b_member     atla-owamp-v6.es.net
</group>

##########################################################################################
# Tests
##
<test>
  description       ESnet Next Generation IPv4 Throughput Testing 
  group             throughput_group 
  test_spec         bwctl_6h_iperf3_test_scavenger 
</test>

<test>
  description       ESnet Next Generation IPv4 Loss Testing
  group             latency_group 
  test_spec         owamp_test 
</test>

<test>
  description       ESnet Next Generation IPv4 Ping Testing
  group             latency_group
  test_spec         ping_test
</test>

<test>
  description       ESnet Next Generation IPv4 Tracepath (Throughput Path) Testing
  group             throughput_group
  test_spec         tracepath_test
</test>

<test>
  description       ESnet Next Generation IPv4 Tracepath (Latency/Loss Path) Testing
  group             latency_group
  test_spec         tracepath_test
</test>

#V6 Tests
<test>
  description       ESnet Next Generation IPv6 Throughput Testing 
  group             throughput_group_ipv6
  test_spec         bwctl_6h_iperf3_test_scavenger 
</test>

<test>
  description       ESnet Next Generation IPv6 Loss Testing
  group             latency_group_ipv6
  test_spec         owamp_test 
</test>

<test>
  description       ESnet Next Generation IPv6 Ping Testing
  group             latency_group_ipv6
  test_spec         ping_test
</test>

<test>
  description       ESnet Next Generation IPv6 Tracepath (Throughput Path) Testing
  group             throughput_group_ipv6
  test_spec         tracepath_test
</test>

<test>
  description       ESnet Next Generation IPv6 Tracepath (Latency/Loss Path) Testing
  group             latency_group_ipv6
  test_spec         tracepath_test
</test>

