#################################################
# BES Mesh Config File
#
###

description BES perfSONAR Mesh

<administrator>
  name	Jason Zurawski
  email	zurawski@es.net
</administrator>

#################################################
# Organizations
##

## ANL
<organization>
    description 	ANL
    
    <site>

        <host>
              # BWCTL & OWAMP host
              description anlborder-ps.it.anl.gov
              address  anlborder-ps.it.anl.gov
              <measurement_archive>
                  type        perfsonarbuoy/bwctl
                  read_url    http://anlborder-ps.it.anl.gov/esmond/perfsonar/archive
                  write_url   http://anlborder-ps.it.anl.gov/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://anlborder-ps.it.anl.gov/esmond/perfsonar/archive
                  write_url   http://anlborder-ps.it.anl.gov/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://anlborder-ps.it.anl.gov/esmond/perfsonar/archive
                  write_url   http://anlborder-ps.it.anl.gov/esmond/perfsonar/archive
              </measurement_archive>
        </host>

    </site>
    
</organization>

## APS @ ANL
<organization>
    description 	APS @ ANL
    
    <site>

        <host>
              # BWCTL & OWAMP host
              description prfsnr-xraya.xray.aps.anl.gov
              address  prfsnr-xraya.xray.aps.anl.gov
              <measurement_archive>
                  type        perfsonarbuoy/bwctl
                  read_url    http://prfsnr-xraya.xray.aps.anl.gov/esmond/perfsonar/archive
                  write_url   http://prfsnr-xraya.xray.aps.anl.gov/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://prfsnr-xraya.xray.aps.anl.gov/esmond/perfsonar/archive
                  write_url   http://prfsnr-xraya.xray.aps.anl.gov/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://prfsnr-xraya.xray.aps.anl.gov/esmond/perfsonar/archive
                  write_url   http://prfsnr-xraya.xray.aps.anl.gov/esmond/perfsonar/archive
              </measurement_archive>
        </host>

        <host>
              # BWCTL & OWAMP host
              description prfsnr-xrayb.xray.aps.anl.gov
              address  prfsnr-xrayb.xray.aps.anl.gov
              <measurement_archive>
                  type        perfsonarbuoy/bwctl
                  read_url    http://prfsnr-xrayb.xray.aps.anl.gov/esmond/perfsonar/archive
                  write_url   http://prfsnr-xrayb.xray.aps.anl.gov/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://prfsnr-xrayb.xray.aps.anl.gov/esmond/perfsonar/archive
                  write_url   http://prfsnr-xrayb.xray.aps.anl.gov/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://prfsnr-xrayb.xray.aps.anl.gov/esmond/perfsonar/archive
                  write_url   http://prfsnr-xrayb.xray.aps.anl.gov/esmond/perfsonar/archive
              </measurement_archive>
        </host>

    </site>
    
</organization>



## BNL
<organization>
    description 	BNL
    
    <site>

        <host>
              # BWCTL host
              description lhcmon.bnl.gov
              address  lhcmon.bnl.gov
              <measurement_archive>
                  type        perfsonarbuoy/bwctl
                  read_url    http://lhcmon.bnl.gov/esmond/perfsonar/archive
                  write_url   http://lhcmon.bnl.gov/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://lhcmon.bnl.gov/esmond/perfsonar/archive
                  write_url   http://lhcmon.bnl.gov/esmond/perfsonar/archive
              </measurement_archive>
        </host>

        <host>
              # OWAMP host
              description lhcperfmon.bnl.gov
              address  lhcperfmon.bnl.gov
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://lhcperfmon.bnl.gov/esmond/perfsonar/archive
                  write_url   http://lhcperfmon.bnl.gov/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://lhcperfmon.bnl.gov/esmond/perfsonar/archive
                  write_url   http://lhcperfmon.bnl.gov/esmond/perfsonar/archive
              </measurement_archive>
        </host>

    </site>
    
</organization>




## SLAC
<organization>
    description 	SLAC
    
    <site>

        <host>
              description psnr-farm10.slac.stanford.edu 
              address  psnr-farm10.slac.stanford.edu 
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://psnr-farm10.slac.stanford.edu /esmond/perfsonar/archive
                  write_url   http://psnr-farm10.slac.stanford.edu /esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        perfsonarbuoy/bwctl
                  read_url    http://psnr-farm10.slac.stanford.edu /esmond/perfsonar/archive
                  write_url   http://psnr-farm10.slac.stanford.edu /esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://psnr-farm10.slac.stanford.edu /esmond/perfsonar/archive
                  write_url   http://psnr-farm10.slac.stanford.edu /esmond/perfsonar/archive
              </measurement_archive>
        </host>

        <host>
              description psnr-farm04.slac.stanford.edu
              address  psnr-farm04.slac.stanford.edu
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://psnr-farm04.slac.stanford.edu/esmond/perfsonar/archive
                  write_url   http://psnr-farm04.slac.stanford.edu/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        perfsonarbuoy/bwctl
                  read_url    http://psnr-farm04.slac.stanford.edu/esmond/perfsonar/archive
                  write_url   http://psnr-farm04.slac.stanford.edu/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://psnr-farm04.slac.stanford.edu/esmond/perfsonar/archive
                  write_url   http://psnr-farm04.slac.stanford.edu/esmond/perfsonar/archive
              </measurement_archive>
        </host>

    </site>
    
</organization>




## ORNL
<organization>
    description 	ORNL
    
    <site>

        <host>
              # BWCTL & OWAMP host
              description perfsonar.ornl.gov
              address  perfsonar.ornl.gov
              <measurement_archive>
                  type        perfsonarbuoy/bwctl
                  read_url    http://perfsonar.ornl.gov/esmond/perfsonar/archive
                  write_url   http://perfsonar.ornl.gov/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://perfsonar.ornl.gov/esmond/perfsonar/archive
                  write_url   http://perfsonar.ornl.gov/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://perfsonar.ornl.gov/esmond/perfsonar/archive
                  write_url   http://perfsonar.ornl.gov/esmond/perfsonar/archive
              </measurement_archive>
        </host>

    </site>
    
</organization>



## LBL
<organization>
    description 	LBL
    
    <site>

        <host>
              # BWCTL host
              description ps-sr1-als-bwctl.lbl.gov
              address  ps-sr1-als-bwctl.lbl.gov
              <measurement_archive>
                  type        perfsonarbuoy/bwctl
                  read_url    http://ps-sr1-als-bwctl.lbl.gov/esmond/perfsonar/archive
                  write_url   http://ps-sr1-als-bwctl.lbl.gov/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://ps-sr1-als-bwctl.lbl.gov/esmond/perfsonar/archive
                  write_url   http://ps-sr1-als-bwctl.lbl.gov/esmond/perfsonar/archive
              </measurement_archive>
        </host>

        <host>
              # OWAMP host
              description ps-sr1-als-owamp.lbl.gov
              address  ps-sr1-als-owamp.lbl.gov
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://ps-sr1-als-owamp.lbl.gov/esmond/perfsonar/archive
                  write_url   http://ps-sr1-als-owamp.lbl.gov/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://ps-sr1-als-owamp.lbl.gov/esmond/perfsonar/archive
                  write_url   http://ps-sr1-als-owamp.lbl.gov/esmond/perfsonar/archive
              </measurement_archive>
        </host>

        <host>
              # BWCTL host
              description ps-border1-pt.lbl.gov
              address  ps-border1-pt.lbl.gov
              <measurement_archive>
                  type        perfsonarbuoy/bwctl
                  read_url    http://ps-border1-pt.lbl.gov/esmond/perfsonar/archive
                  write_url   http://ps-border1-pt.lbl.gov/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://ps-border1-pt.lbl.gov/esmond/perfsonar/archive
                  write_url   http://ps-border1-pt.lbl.gov/esmond/perfsonar/archive
              </measurement_archive>
        </host>

        <host>
              # OWAMP host
              description ps-border1-owamp.lbl.gov
              address  ps-border1-owamp.lbl.gov
              <measurement_archive>
                  type        perfsonarbuoy/owamp
                  read_url    http://ps-border1-owamp.lbl.gov/esmond/perfsonar/archive
                  write_url   http://ps-border1-owamp.lbl.gov/esmond/perfsonar/archive
              </measurement_archive>
              <measurement_archive>
                  type        traceroute
                  read_url    http://ps-border1-owamp.lbl.gov/esmond/perfsonar/archive
                  write_url   http://ps-border1-owamp.lbl.gov/esmond/perfsonar/archive
              </measurement_archive>
        </host>

    </site>
    
</organization>


## ESnet
<organization>
    description 	ESnet

    <site>

        <host>
              no_agent 1
              description anl-pt1.es.net
              address anl-pt1.es.net
              address anl-pt1-v6.es.net
        </host>

        <host>
              no_agent 1
              description anl-owamp.es.net
              address anl-owamp.es.net
              address anl-owamp-v6.es.net
        </host>

    </site>

    <site>

        <host>
              no_agent 1
              description bnl-pt1.es.net
              address bnl-pt1.es.net
              address bnl-pt1-v6.es.net
        </host>

        <host>
              no_agent 1
              description bnl-owamp.es.net
              address bnl-owamp.es.net
              address bnl-owamp-v6.es.net
        </host>

    </site>

    <site>

        <host>
              no_agent 1
              description slac-pt1.es.net
              address slac-pt1.es.net
              address slac-pt1-v6.es.net
        </host>

        <host>
              no_agent 1
              description slac-owamp.es.net
              address slac-owamp.es.net
              address slac-owamp-v6.es.net
        </host>

    </site>

    <site>

        <host>
              no_agent 1
              description ornl-pt1.es.net
              address ornl-pt1.es.net
              address ornl-pt1-v6.es.net
        </host>

        <host>
              no_agent 1
              description ornl-owamp.es.net
              address ornl-owamp.es.net
              address ornl-owamp-v6.es.net
        </host>

    </site>

    <site>

        <host>
              no_agent 1
              description lbl-pt1.es.net
              address lbl-pt1.es.net
              address lbl-pt1-v6.es.net
        </host>

        <host>
              no_agent 1
              description lbl-owamp.es.net
              address lbl-owamp.es.net
              address lbl-owamp-v6.es.net
        </host>

    </site>

</organization>

##########################################################################################
# Test specifications
##

<test_spec bwctl_6h_tcp_test>
  # Define a test spec for testing achievable bandwidth once every 6 hours
  type              perfsonarbuoy/bwctl	# Perform a bwctl test (i.e. achievable bandwidth)
  tool              bwctl/iperf3			# Use 'iperf' to do the bandwidh test
  protocol          tcp					# Run a TCP bandwidth test
  interval          21600				# Run the test every 6 hours
  duration          30					# Perform a 20 second test
  force_bidirectional 0				# do bidirectional test
  random_start_percentage 25		# randomize start time
  omit_interval	10					# ignore first 5 seconds 
</test_spec>

<test_spec owamp_test>
  # Define a test spec for doing jitter, loss and latency testing

  type              perfsonarbuoy/owamp	# Perform a constant low-bandwidth OWAMP test
  packet_interval   0.1				# Send 10 packets every second (i.e. pause 0.1 seconds between each packet)
  loss_threshold    10				# Wait no more than 10 seconds for a response
  session_count     10800			# Refresh the test every half hour (once every 18000 packets)
  sample_count      600				# Send results back every 30 seconds (once every 300 packets)
  packet_padding    0				# The size of the packets (not including the IP/UDP headers)
  bucket_width      0.0001			# The granularity of the measurements
  force_bidirectional 1				# do bidirectional test
</test_spec>

<test_spec traceroute_test>
  # Define a test spec for running traceroute tests every 10 minutes

  type              traceroute			# Perform a traceroute test
  test_interval     600 				# Run the test every 10 minutes
  protocol          udp				# Run a UDP traceroute (could also be 'icmp')
  timeout           30					# Wait 30 seconds 
  pause             0					# Number of seconds to pause between each traceroute probe
  waittime          5					# Number of seconds to wait for a response before assuming its lost
  packet_size       40 				# The size of the packets (not include IP/UDP headers)
</test_spec>

##########################################################################################
# Groups
##

<group full_bes_bwctl>
    type       mesh
    
    member	prfsnr-xraya.xray.aps.anl.gov
    member	prfsnr-xrayb.xray.aps.anl.gov
    member	lhcmon.bnl.gov
    member	psnr-farm04.slac.stanford.edu
    member	psnr-farm10.slac.stanford.edu 
    member	perfsonar.ornl.gov
#    member	ps-sr1-als-bwctl.lbl.gov
    member	ps-border1-pt.lbl.gov
</group>

<group full_bes_owamp>
    type       mesh
    
    member	prfsnr-xraya.xray.aps.anl.gov
    member	prfsnr-xrayb.xray.aps.anl.gov
    member	lhcperfmon.bnl.gov
    member	psnr-farm10.slac.stanford.edu 
    member	psnr-farm04.slac.stanford.edu
    member	perfsonar.ornl.gov
#    member	ps-sr1-als-owamp.lbl.gov
    member	ps-border1-owamp.lbl.gov
</group>

<group anl_bes_bwctl>
    type		disjoint

    a_member	anl-pt1.es.net
    a_member	bnl-pt1.es.net
    a_member	slac-pt1.es.net
    a_member	ornl-pt1.es.net
    a_member	lbl-pt1.es.net
    
    b_member	prfsnr-xraya.xray.aps.anl.gov
    b_member	prfsnr-xrayb.xray.aps.anl.gov
</group>

<group anl_bes_owamp>
    type		disjoint

    a_member	anl-owamp.es.net
    a_member	bnl-owamp.es.net
    a_member	slac-owamp.es.net
    a_member	ornl-owamp.es.net
    a_member	lbl-owamp.es.net
    
    b_member	prfsnr-xraya.xray.aps.anl.gov
    b_member	prfsnr-xrayb.xray.aps.anl.gov
</group>

<group bnl_bes_bwctl>
    type		disjoint

    a_member	anl-pt1.es.net
    a_member	bnl-pt1.es.net
    a_member	slac-pt1.es.net
    a_member	ornl-pt1.es.net
    a_member	lbl-pt1.es.net
    
    b_member	lhcmon.bnl.gov
</group>

<group bnl_bes_owamp>
    type		disjoint

    a_member	anl-owamp.es.net
    a_member	bnl-owamp.es.net
    a_member	slac-owamp.es.net
    a_member	ornl-owamp.es.net
    a_member	lbl-owamp.es.net
    
    b_member	lhcperfmon.bnl.gov
</group>

<group slac_bes_bwctl>
    type		disjoint

    a_member	anl-pt1.es.net
    a_member	bnl-pt1.es.net
    a_member	slac-pt1.es.net
    a_member	ornl-pt1.es.net
    a_member	lbl-pt1.es.net
    
    b_member	psnr-farm10.slac.stanford.edu 
    b_member	psnr-farm04.slac.stanford.edu
</group>

<group slac_bes_owamp>
    type		disjoint

    a_member	anl-owamp.es.net
    a_member	bnl-owamp.es.net
    a_member	slac-owamp.es.net
    a_member	ornl-owamp.es.net
    a_member	lbl-owamp.es.net
    
    b_member	psnr-farm10.slac.stanford.edu 
    b_member	psnr-farm04.slac.stanford.edu
</group>

<group ornl_bes_bwctl>
    type		disjoint

    a_member	anl-pt1.es.net
    a_member	bnl-pt1.es.net
    a_member	slac-pt1.es.net
    a_member	ornl-pt1.es.net
    a_member	lbl-pt1.es.net
    
    b_member	perfsonar.ornl.gov
</group>

<group ornl_bes_owamp>
    type		disjoint

    a_member	anl-owamp.es.net
    a_member	bnl-owamp.es.net
    a_member	slac-owamp.es.net
    a_member	ornl-owamp.es.net
    a_member	lbl-owamp.es.net
    
    b_member	perfsonar.ornl.gov
</group>

<group lbl_bes_bwctl>
    type		disjoint

    a_member	anl-pt1.es.net
    a_member	bnl-pt1.es.net
    a_member	slac-pt1.es.net
    a_member	ornl-pt1.es.net
    a_member	lbl-pt1.es.net
    
#    b_member	ps-sr1-als-bwctl.lbl.gov
    b_member	ps-border1-pt.lbl.gov
</group>

<group lbl_bes_owamp>
    type		disjoint

    a_member	anl-owamp.es.net
    a_member	bnl-owamp.es.net
    a_member	slac-owamp.es.net
    a_member	ornl-owamp.es.net
    a_member	lbl-owamp.es.net
    
#    b_member	ps-sr1-als-owamp.lbl.gov
    b_member	ps-border1-owamp.lbl.gov
</group>

##########################################################################################
# Tests
##

<test>
  description		BES Throughput Testing 
  group			full_bes_bwctl
  test_spec		bwctl_6h_tcp_test
</test>

<test>
  description		BES OWAMP Testing 
  group 			full_bes_owamp
  test_spec		owamp_test
</test>

<test>
  description		BES Traceroute Testing 
  group			full_bes_owamp
  test_spec		traceroute_test
</test>

<test>
  description		ANL BES Throughput Testing 
  group			anl_bes_bwctl
  test_spec		bwctl_6h_tcp_test
</test>

<test>
  description		ANL BES OWAMP Testing 
  group 			anl_bes_owamp
  test_spec		owamp_test
</test>

<test>
  description		ANL BES Traceroute Testing 
  group			anl_bes_owamp
  test_spec		traceroute_test
</test>

<test>
  description		BNL BES Throughput Testing 
  group			bnl_bes_bwctl
  test_spec		bwctl_6h_tcp_test
</test>

<test>
  description		BNL BES OWAMP Testing 
  group 			bnl_bes_owamp
  test_spec		owamp_test
</test>

<test>
  description		BNL BES Traceroute Testing 
  group			bnl_bes_owamp
  test_spec		traceroute_test
</test>

<test>
  description		SLAC BES Throughput Testing 
  group			slac_bes_bwctl
  test_spec		bwctl_6h_tcp_test
</test>

<test>
  description		SLAC BES OWAMP Testing 
  group 			slac_bes_owamp
  test_spec		owamp_test
</test>

<test>
  description		SLAC BES Traceroute Testing 
  group			slac_bes_owamp
  test_spec		traceroute_test
</test>

<test>
  description		ORNL BES Throughput Testing 
  group			ornl_bes_bwctl
  test_spec		bwctl_6h_tcp_test
</test>

<test>
  description		ORNL BES OWAMP Testing 
  group 			ornl_bes_owamp
  test_spec		owamp_test
</test>

<test>
  description		ORNL BES Traceroute Testing 
  group			ornl_bes_owamp
  test_spec		traceroute_test
</test>

<test>
  description		LBL  BES Throughput Testing 
  group			lbl_bes_bwctl
  test_spec		bwctl_6h_tcp_test
</test>

<test>
  description		LBL  BES OWAMP Testing 
  group 			lbl_bes_owamp
  test_spec		owamp_test
</test>

<test>
  description		LBL  BES Traceroute Testing 
  group			lbl_bes_owamp
  test_spec		traceroute_test
</test>